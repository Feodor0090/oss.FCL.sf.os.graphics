//
// Copyright (c) 2005-2009 Nokia Corporation and/or its subsidiary(-ies).
// All rights reserved.
// This component and the accompanying materials are made available
// under the terms of "Eclipse Public License v1.0"
// which accompanies this distribution, and is available
// at the URL "http://www.eclipse.org/legal/epl-v10.html".
//
// Initial Contributors:
// Nokia Corporation - initial contribution.
//
// Contributors:
//
// Description:
//
//! @file 
//! @SYMTestSuiteName  GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi
//! @SYMScriptTestEnvironment This test script requires a basic ROM.

///////////////////////////////////////////////////////////////////////////////
// GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.script
//
// Tests all public elements of the MAnimGeneralFunctions class
// as a means of confidence that the API works as expected.
//
// The purpose is to provide a regression test suite of PublishedAll APIs for
// MAnimGeneralFunctions related classes.
// Negative caseing is performed to confirm that correct errors are returned
// when incorrect parameters are given.
//
// The tests are fully automated.
///////////////////////////////////////////////////////////////////////////////

LOAD_SUITE      T_GraphicsWservAPI
DELAY           1000


// ****************************************************************************
// MAnimGeneralFunctions
// ****************************************************************************



START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001
//!@SYMAPI                   MAnimGeneralFunctions::Animate(TDateTime {ptr})
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralAnimate to animation DLL by CommandReply to start animation , and then check 
//!                          if the returned result is the expected one.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralAnimate with a specified TDateTime parameter to animation DLL by CommandReply.
//!                          9.1 The wrapper check the returned result from step 8 is correct(1) or not.
//!                          10. Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns 1(stands for True).
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0001


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002
//!@SYMAPI                   MAnimGeneralFunctions::Client()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralClient to animation DLL by CommandReply to get a reference to the calling client's thread ,
//!                          and then check if the returned threadId is the expected one.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralClient with client thread id to animation DLL by CommandReply.
//!                          9.1 Plugin gets a reference to the calling client's thread and return to client.
//!                          9.2 The wrapper check if the threadId equals to the client one. If not, set this case fail.
//!                          10. Destroy RAnim and RAnimForMClass
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns the client thread id properly.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002-0001-CommandReply_Command14
        COMMAND                    animformc                Destroy                  
        COMMAND                    anim                     Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0002


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003
//!@SYMAPI                   MAnimGeneralFunctions::FlashStateOn()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralFlashStateOn to animation DLL by CommandReply to get the current flash cycle state,
//!                          the plugin will verify if the state's correct and return the result to client. 
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralFlashStateOn to animation DLL by CommandReply.
//!                          9.1 Plugin check if the FlashStateOn function execute expectedly. If does, return 1, else return 0.
//!                          9.2 The wrapper check the returned value is 1 or not. If 0, set this case fail.
//!                          10. Destroy RAnim and RAnimForMClass
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns 1(stands for True).
//!@SYMTestType              CIT
    START_TEST_BLOCK          20          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-Construct_Command13
        DELAY                      2000000                                           
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0003


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004
//!@SYMAPI                   MAnimGeneralFunctions::Panic()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralPanic to animation DLL by CommandReply to execute the MAnimGeneralFunctions::Panic(), and then see if the client is panicked.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralPanic to animation DLL by CommandReply.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   Client is panic with WSERV:22.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004-0001-CommandReply_Command14
    END_TEST_BLOCK    !PanicString=WSERV    !PanicCode=22
    RUN_TEST_STEP          100          T_GraphicsWservAPI          utilityClearPanicDlg

END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0004


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005
//!@SYMAPI                   MAnimGeneralFunctions::ScreenDevice()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralScreenDevice to animation DLL by CommandReply to get a pointer to the screen device,
//!                          then the plugin will execute one CFbsScreenDevice function and return 0 to client if execute successfully.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralScreenDevice to animation DLL by CommandReply.
//!                          9.1 Plugin invoke one CFbsScreenDevice function to verify if the CFbsScreenDevice pointer which is returned by MAnimGeneralFunctions::ScreenDevice() works or not .
//!                          If it works,  return 0 to client.
//!                          9.2 The wrapper check if the return code is 0. If not, set this case failed.
//!                          10. Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   The CommandReply return 0 to client in step 9, which means the Plugin has executed one CFbsScreenDevice function successfully.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0005


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006
//!@SYMAPI                   MAnimGeneralFunctions::ExtendedInterface(TInt)
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralExtendedInterface with parameter 0(ENumberOfExtendedInterfaces)
//!                          to animation DLL to get the number of extended interfaces, and then check if the returned result is the expected one.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralExtendedInterface with parameter equals to 0 to animation DLL by CommandReply.
//!                          9.1 Plugin invoke the MAnimGeneralFunctions::ExtendedInterface(0) and return the result.
//!                          9.2 The wrapper check if the value equals to the expected value.If not, set this case fail.
//!                          10. Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns the number of extended interface(currently, it is 2).
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0006


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007
//!@SYMAPI                   MAnimGeneralFunctions::ExtendedInterface(TInt)
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralExtendedInterface with parameter 1(EWindowExtensionInterface) to animation DLL 
//!                          to get a pointer to the window extension interface, check if it works or not, and return the result to client. 
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralExtendedInterface with parameter equals to 1 to animation DLL by CommandReply
//!                          9.1 Plugin invoke one MAnimGeneralFunctionsWindowExtension member function to verify if the pointer which is returned by MAnimGeneralFunctions::ExtendedInterface(1) works or not .
//!                          If works, Plugin return 0 to client.
//!                          9.2 The wrapper check the returned value is 0.If not 0, set this case fail.
//!                          10. Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns 0 in step 9.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0007


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008
//!@SYMAPI                   MAnimGeneralFunctions::ExtendedInterface(TInt)
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralExtendedInterface with parameter 2(EEventExtentionInterface) to animation DLL 
//!                          to get a pointer to the event extension interface, check if it works or not, and return the result to client. 
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralExtendedInterface with parameter equals to 2 to animation DLL by CommandReply.
//!                          9.1 Plugin invoke one MAnimGeneralFunctionsEventExtension member function to verify if the pointer which is returned by MAnimGeneralFunctions::ExtendedInterface(2) works or not.
//!                          If it works, Plugin return 0 to client.
//!                          9.2 The wrapper check the returned value is 0. If not 0, set this case fail.
//!                          10.  Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns 0 in step 9.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0008


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009
//!@SYMAPI                   MAnimGeneralFunctions::ExtendedInterface(TInt)
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          07-05-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralExtendedInterface with parameter 4(an unexisted interface number)
//!                          to animation DLL, and then check if the returned result is a NULL pointer.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralExtendedInterface with parameter equals to 4 to animation DLL by CommandReply.
//!                          9.1 Plugin invoke the MAnimGeneralFunctions::ExtendedInterface(4) and return the result.
//!                          9.2 The wrapper check if the returned pointer is NULL. If not, set this case fail.
//!                          10.  Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns a NULL pointer.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0009


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010
//!@SYMAPI                   MAnimGeneralFunctions::WindowExtension()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralWindowExtension to animation DLL to get one pointer to the MAnimGeneralFunctionsWindowExtension,
//!                          and check if it works and return the result to client.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralWindowExtension to animation DLL by CommandReply.
//!                          9.1 Plugin invoke one MAnimGeneralFunctionsWindowExtension member function to verify if the pointer which is returned by MAnimGeneralFunctions::WindowExtension() works or not.
//!                          If it works, Plugin return 0 to client .
//!                          9.2 The wrapper check the returned value is 0. If not 0, set this case fail.
//!                          10. Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns 0 in step 9.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0010


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011
//!@SYMAPI                   MAnimGeneralFunctions::NumberofExtendedInterfaces()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralNumofExtInterfaces to animation DLL to get the number of extended interfaces .
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralNumofExtInterfaces to animation DLL by CommandReply.
//!                          9.1 Plugin get the number of extended interface and return it to client.
//!                          9.2 The wrapper check if the number equals to the expected one. it not,set this case fail.
//!                          10.  Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns the number of extended interfaces(currently it is 2 )
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0011


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012
//!@SYMAPI                   MAnimGeneralFunctions::EventExtension()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralEventExtension to animation DLL to 
//!                          get one pointer to the MAnimGeneralFunctionsEventExtension object.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralEventExtension to animation DLL by CommandReply.
//!                          9.1 Plugin invoke one MAnimGeneralFunctionsEventExtension member function to verify if the pointer which is returned by MAnimGeneralFunctions::EventExtension() works or not.
//!                          If it works, the Plugin return 0 to client.
//!                          9.2 The wrapper check the returned value is 0. If not 0, set this case fail.
//!                          10. Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply returns 0 in step 9.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0012


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013
//!@SYMAPI                   MAnimGeneralFunctions::GetRawEvents(TBool)
//!@SYMAuthor                Albert Wu
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralGetRawEvents with ETrue/EFalse parameter to animation DLL by CommandReply 
//!                          to switch the animation raw event handling on/off.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralGetRawEvents with ETrue parameter to animation DLL by CommandReply.
//!                          9.1 The plugin invoke the GetRawEvents of MAnimGeneralFunctions class. If execute successfully, return 0.
//!                          9.2 The wrapper check if the return code is 0 (it means successfully)
//!                          10. Send ECmdGeneralGetRawEvents with EFalse parameter to animation DLL by CommandReply.
//!                          10.1 The plugin invoke the GetRawEvents of MAnimGeneralFunctions class. If execute successfully, return 0.
//!                          10.2 The wrapper check if the return code is 0 ( it means successfully)
//!                          11. Destroy RAnim and RAnimForMClass.
//!                          12. Destroy RAnimDll.
//!                          13. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   The return results of CommandReply are 0(it means MAnimGeneralFunctions::GetRawEvent executed successfully);
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013-0001-CommandReply_Command15
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0013


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014
//!@SYMAPI                   MAnimGeneralFunctions::PostRawEvent(const TRawEvent {ref})                       
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The first phase :the client sends command ECmdGeneralGetRawEvents to animation DLL by CommandReply to switch the raw event handling on, 
//!                          then send command ECmdGeneralPostRawEvent to animation DLL to post some raw event,after a short interval check if the event has been received.
//!                          The second phase : the client sends command ECmdGeneralGetRawEvents to animation DLL by CommandReply to switch the raw event handling off, 
//!                          then send command ECmdGeneralPostRawEvent to animation DLL to post some raw event,after a short interval check if the event has not been received.  
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralGetRawEvents with ETrue parameter to animation DLL by CommandReply.
//!                          10.  Send ECmdGeneralPostRawEvent with TRawEvent parameter to animation DLL by CommandReply.
//!                          11. Delay 1 second.
//!                          12. Send ECmdRetrieveResult animation DLL by CommandReply.
//!                          12.1 The wrapper check if the return code equals to the expected one(ETure). If not, set this case failed.
//!                          13. Send ECmdGeneralGetRawEvents with EFalse parameter to animation DLL by CommandReply.
//!                          14. Send ECmdGeneralPostRawEvent with TRawEvent parameter to animation DLL by CommandReply.
//!                          15. Delay 1 second.
//!                          16. Send ECmdRetrieveResult animation DLL by CommandReply.
//!                          16.1 The wrapper check if the return code equals to the expected one(EFalse). If not, set this case failed.
//!                          17. Destroy RAnim and RAnimForMClass.
//!                          18. Destroy RAnimDll.
//!                          19. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   1.The first CommandReply with ECmdRetrieveResult operation code return 1(it means the raw event has been posted to the plugin dll).
//!                          2.The second CommandReply with ECmdRetrieveResult operation code return 0(it means the raw event has not been posted to the plugin dll).
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-CommandReply_Command15
        DELAY                      1000000                                           
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-CommandReply_Command17
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-CommandReply_Command18
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-CommandReply_Command19
        DELAY                      1000000                                           
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014-0001-CommandReply_Command21
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0014


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015
//!@SYMAPI                   MAnimGeneralFunctions::PostKeyEvent(const TKeyEvent {ref})
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralPostKeyEvent with a certain key to animation DLL to post key event, then check if the keyevent post equals to the key input just now.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralPostKeyEvent with an TKeyEvent object to animation DLL by CommandReply.
//!                          9.1 Using Windowgroup to capture a certain key event.
//!                          9.2 Send ECmdGeneralPostKeyEvent with a certain key to animation Dll.
//!                          9.3 Plugin Dll will send a key event using the method PostKeyEvent.
//!                          9.4 Client wait for the notification of the WsSession.
//!                          9.5 The WindowGroup capture the key event and compare to the certain event type.
//!                          10.  Wrapper check if the return code equals to the expected one(ETure). If not, set this case failed.
//!                          11. Destroy RAnim and RAnimForMClass.
//!                          12. Destroy RAnimDll.
//!                          13. Close RWsSession,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   Step 9.5 capture the correct key event which is posted by animation DLL previously.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0015


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016
//!@SYMAPI                   MAnimGeneralFunctions::Sync()
//!@SYMAuthor                Albert Wu
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralSync to animation DLL by CommandReply to get the current sync mode.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralSync to animation DLL by CommandReply.
//!                          9.1 The plugin return the current synchronisation mode .
//!                          9.2 The wrapper check the returned result is correct.
//!                          10. Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   In step 9, CommandReply returns ESyncNone (No explicit sync mode set, so the returned sync mode here is ESyncNone). 
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0016


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017
//!@SYMAPI                   MAnimGeneralFunctions::SetSync(TAnimSync)
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralSetSync to animation DLL by CommandReply to set sync mode as client asked, then check if it is the expected one via sending
//!                          command ECmdGeneralSync to animation DLL to get the current sync mode.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralSetSync with ESyncNone to animation DLL by CommandReply.
//!                          10. Send ECmdGeneralSync to animation DLL by CommandReply.
//!                          10.1 The wrapper check the returned result is ESyncNone.
//!                          11. Send ECmdGeneralSetSync with ESyncFlash to animation DLL by CommandReply.
//!                          12. Send ECmdGeneralSync to animation DLL by CommandReply.
//!                          12.1 The wrapper check the returned result is ESyncFlash.
//!                          13. Send ECmdGeneralSetSync with ESyncSecond to animation DLL by CommandReply.
//!                          14. Send ECmdGeneralSync to animation DLL by CommandReply.
//!                          14.1 The wrapper check the returned result is ESyncSecond.
//!                          15. Send ECmdGeneralSetSync with ESyncMinute to animation DLL by CommandReply.
//!                          16. Send ECmdGeneralSync to animation DLL by CommandReply.
//!                          16.1 The wrapper check the returned result is ESyncMinute.
//!                          17. Send ECmdGeneralSetSync with ESyncDay to animation DLL by CommandReply.
//!                          18. Send ECmdGeneralSync to animation DLL by CommandReply.
//!                          18.1 The wrapper check the returned result is ESyncDay.
//!                          19. Destroy RAnim and RAnimForMClass.
//!                          20. Destroy RAnimDll.
//!                          21. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   1.In step 10, CommandReply returns ESyncNone.
//!                          2.In step 12, CommandReply returns ESyncFlash.
//!                          3.In step 14, CommandReply returns ESyncSecond.
//!                          4.In step 16, CommandReply returns ESyncMinute.
//!                          4.In step 18, CommandReply returns ESyncDay.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command15
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command16
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command17
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command18
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command19
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command20
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command21
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command22
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017-0001-CommandReply_Command23
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0017


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018
//!@SYMAPI                   MAnimGeneralFunctions::SetInterval(TInt)
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command to animation DLL to set the synchronisation mode as TAnimSync::ESyncNone and desired animation interval,
//!                          then the Animate() function is called at the defined interval.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSetSync to set the synchronisation mode with TAnimSync::ESyncNone.
//!                          10.Send command ECmdGeneralSetInterval with 4 flash ticks to animation DLL by CommandReply .
//!                          10.1 Plugin calculate and verify the interval has been set to 4 flash ticks.
//!                          11.Delay 8 seconds.
//!                          12.Send command ECmdReceiveResult to animation DLL by CommandReply.
//!                          12.1 The wrapper check if the return code equals to the expected code(1 stands for success).
//!                          13.Send command ECmdGeneralSetInterval with 1 flash tick to animation DLL by CommandReply.
//!                          13.1 Plugin calculate and verify the interval has been set to 1 flash tick.
//!                          14.Delay 2 seconds.
//!                          15.Send command ECmdReceiveResult to animation DLL by CommandReply .
//!                          15.1 The wrapper check if the return code equals to the expected code(1 stands for success).
//!                          16.Destroy RAnim and RAnimForMClass.
//!                          17.Destroy RAnimDll.
//!                          18.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   All CommandReply with ECmdRetrieveResult operation code return 1.                         
//!@SYMTestType              CIT
    START_TEST_BLOCK          200          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-CommandReply_Command15
        DELAY                      8000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-CommandReply_Command17
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-CommandReply_Command18
        DELAY                      2000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018-0001-CommandReply_Command20
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0018


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019
//!@SYMAPI                   MAnimGeneralFunctions::SetInterval(TInt)
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command to animation DLL to set interval to 0, the countdown stops and the Animate() function is no longer called.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSetSync to set the synchronisation mode with TAnimSync::ESyncNone.
//!                          10.Send command ECmdGeneralSetInterval with 4 flash ticks to animation DLL by CommandReply.
//!                          10.1 Plugin calculate and verify the interval has been set to 4 flash ticks.
//!                          11.Delay 8 seconds.
//!                          12.Send command ECmdReceiveResult to animation DLL .
//!                          12.1 The wrapper check if the return code equals to the expected code(1 stands for success).
//!                          13.Send command ECmdGeneralSetInterval with 0 flash tick to animation DLL by CommandReply.
//!                          13.1 Plugin calculate and verify the interval has been set to 0 flash tick.
//!                          14.Delay 2 seconds.
//!                          15.Send command ECmdReceiveResult to animation DLL .
//!                          15.1 The wrapper check if the return code equals to the expected code(1 stands for success).
//!                          16.Destroy RAnim and RAnimForMClass.
//!                          17.Destroy RAnimDll.
//!                          18.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   CommandReply with ECmdRetrieveResult operation code return 1.
//!@SYMTestType              CIT
    START_TEST_BLOCK          200          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-CommandReply_Command15
        DELAY                      8000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-CommandReply_Command17
        DELAY                      2000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019-0001-CommandReply_Command19
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0019


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020
//!@SYMAPI                   MAnimGeneralFunctions::SetInterval(TInt)
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          Negative case. The client sends command to set the synchronisation mode as TAnimSync::ESyncNone,
//!                          then send command to set the interval with a negative number.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSetSync to set the synchronisation mode with TAnimSync::ESyncNone.
//!                          10.Send command ECmdGeneralSetInterval with 4 flash ticks to animation DLL by CommandReply.
//!                          10.1 Plugin calculate and verify the interval has been set to 4 flash ticks.
//!                          11.Delay 8 seconds.
//!                          12.Send command ECmdRetrieveResult to animation DLL .
//!                          12.1 The wrapper check if the return code equals to the expected code(1 stands for success).
//!                          13.Send command ECmdGeneralSetInterval with -4 flash ticks to animation DLL by CommandReply(OutStanding after this command).
//!                          13.1 Plugin calculate and verify the interval has been set to 0 flash tick.
//!                          14.Delay 8 seconds.
//!                          15.Send command ECmdRetrieveResult to animation DLL .
//!                          15.1 The wrapper check if the return code equals to the expected code(1 stands for success).
//!                          16.Destroy RAnim and RAnimForMClass.
//!                          17.Destroy RAnimDll.
//!                          18.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   All CommandReply with ECmdRetrieveResult operation code return 1.
//!@SYMTestType              CIT
    START_TEST_BLOCK          200          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-CommandReply_Command15
        DELAY                      8000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-CommandReply_Command17
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-CommandReply_Command18
        DELAY                      8000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020-0001-CommandReply_Command20
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0020


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021
//!@SYMAPI                   MAnimGeneralFunctions::SetInterval(TInt)
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          Negative case, the client sends command to animation DLL to set the synchronization mode as TAnimSync::ESyncFlash, 
//!                          then send command to set the animation interval,the window server should panics the client.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSetSync to set the synchronisation mode with TAnimSync::ESyncFlash.
//!                          10.Send command ECmdGeneralSetInterval with 1 flash tick to animation DLL by CommandReply.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   The window server return Panic 22( WServ Panic number )  at step 9.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021-0001-CommandReply_Command15
    END_TEST_BLOCK    !PanicString=WSERV    !PanicCode=22
    RUN_TEST_STEP          100          T_GraphicsWservAPI          utilityClearPanicDlg

END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0021



START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025
//!@SYMAPI                   MAnimGeneralFunctions::SetNextInterval(TInt)
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralSetNextInterval to animation DLL to reset the current countdown to the specified number of flash ticks,
//!                          irrespective of its current value. After the countdown expires, the interval should return to its usual rate.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSetSync to set the synchronisation mode with TAnimSync::ESyncNone.
//!                          10.Send command ECmdGeneralSetNextInterval with 4 flash ticks to animation DLL by CommandReply .
//!                          10.1 Plugin calculate and verify the interval has been changed or not. And will return the result asychronously.
//!                          11.Delay 8 seconds.
//!                          12.Send the CommandReply with ECmdReceiveResult opcode to animation DLL .
//!                          12.1 The wrapper check if the return code equals to the expected code(1 stands for success).
//!                          13.Destroy RAnim and RAnimForMClass.
//!                          14.Destroy RAnimDll.
//!                          15.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   The CommandReply with ECmdRetrieveResult operation code return 1.
//!@SYMTestType              CIT
    START_TEST_BLOCK          1000          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-CommandReply_Command15
        DELAY                      8000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025-0001-CommandReply_Command17
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0025


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026
//!@SYMAPI                   MAnimGeneralFunctions::SetNextInterval(TInt)
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          Negative case, the client sends command to animation DLL to set the synchronization mode as TAnimSync::ESyncFlash, 
//!                          then send command ECmdGeneralSetNextInterval to set the animation next interval,the window server should panics the client.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSetSync to set the synchronisation mode with TAnimSync::ESyncFlash.
//!                          10.Send command ECmdGeneralSetNextInterval with 1 flash tick to animation DLL by CommandReply.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   The window server return Panic 22( WServ Panic number ) at step 10.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026-0001-CommandReply_Command15
    END_TEST_BLOCK    !PanicString=WSERV    !PanicCode=22
    RUN_TEST_STEP          100          T_GraphicsWservAPI          utilityClearPanicDlg

END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0026



START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030
//!@SYMAPI                   MAnimGeneralFunctions::SetNextInterval(TInt)
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          The client sends command to animation DLL to set the synchronization mode as TAnimSync::ESyncNone, 
//!                          then sends command ECmdGeneralSetNextInterval to set the animation next interval to 0, at last sends command ECmdGeneralSetNextInterval to set the next interval to a negative value.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSetSync to set the synchronisation mode with TAnimSync::ESyncNone.
//!                          10.Send command ECmdGeneralSetInterval with 4 flash ticks to animation DLL by CommandReply .
//!                          10.1 Plugin calculate and verify the interval has been changed or not. And will return the result asychronously.
//!                          11.Delay 8 seconds.
//!                          11.1 Wrapper check if the return code equals to the expected code(1 stands for success).
//!                          12.Send command ECmdGeneralSetNextInterval with -2 flash ticks to animation DLL by CommandReply .
//!                          13.1 Plugin calculate and verify the interval has been changed or not. And will return the result asychronously.
//!                          14.Delay 1 second.
//!                          15.Send the CommandReply with ECmdRetrieveResult opcode to animation DLL.
//!                          15.1 Wrapper check if the return code equals to the expected code (1 stands for success).
//!                          16.Destroy RAnim and RAnimForMClass.
//!                          17.Destroy RAnimDll.
//!                          18.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   All the CommandReply with ECmdRetrieveResult operation code return 1.
//!@SYMTestType              CIT
    START_TEST_BLOCK          200          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-CommandReply_Command14
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-CommandReply_Command15
        DELAY                      8000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-CommandReply_Command17
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-CommandReply_Command18
        DELAY                      1000000                                          
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030-0001-CommandReply_Command20
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0030


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031
//!@SYMAPI                   MAnimGeneralFunctions::RegisterForNotifications(TUint32)
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          10-04-2008
//!@SYMTestCaseDesc          Register to receive DSA notifications. The client sends command ECmdGeneralRegisterForNotifications to animation DLL via the CommandReply 
//!                          with parameter as 1 to register to receive DSA notifications. Then the client call StartL() of CDirectScreenAccess object to trigger EDirectScreenAccess event, 
//!                          the DLL will trap this event and then return the result to client.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralRegisterForNotifications with 1 to animation DLL by CommandReply.
//!                          10.Create and construct CWsScreenDevice.
//!                          11.Create and construct CWsScreenDevice with the created RWsSession.
//!                          12.Create CDirectScreenAccess object with the created RWsSession,RWindow,CWsScreenDevice.
//!                          13.Call StartL() of CDirectScreenAccess object to trigger EDirectScreenAccess event.
//!                          14.Send the CommandReply with ECmdRetrieveResult opcode to animation DLL .
//!                          15.Send command ECmdGeneralRegisterForNotifications with 0 to animation DLL by CommandReply(To prevent the panic).
//!                          16.Destroy CDirectScreenAccess.
//!                          17.Destroy CWsScreenDevice.
//!                          18.Close RWsSession.
//!                          19.Destroy RAnim and RAnimForMClass.
//!                          20.Destroy RAnimDll.
//!                          21.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   Step 15 return true
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        CREATE_OBJECT              CWsScreenDevice          scrdev
        CREATE_OBJECT              CDirectScreenAccess      dsa
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-CommandReply_Command14
        COMMAND                    scrdev                   new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-new_Command15
        COMMAND                    scrdev                   Construct                
        COMMAND                    dsa                      NewL                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-NewL_Command17
        COMMAND                    dsa                      StartL                   GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-StartL_Command18
        COMMAND                    dsa                      Cancel                   
        COMMAND                    dsa                      ~                        
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-CommandReply_Command21
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031-0001-CommandReply_Command22
        COMMAND                    scrdev                   ~                        
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0031


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034
//!@SYMAPI                   MAnimGeneralFunctions::Message()
//!@SYMAuthor                Jason Lin
//!@SYMCreationDate          11-04-2008
//!@SYMTestCaseDesc          The client sends the command ECmdGeneralMessage to the animation DLL by the CommandReply to get the address of RMessagePtr2 object. 
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Client Send command ECmdGeneralMessage with a string "Send message"  to animation DLL by CommandReply.
//!                          9.1 Plugin return the same string to client via another slot.
//!                          9.2 The wrapper compare the returned string and the original one , to check if it is same. If not, set this case failed.
//!                          10.Destroy RAnim and RAnimForMClass.
//!                          11.Destroy RAnimDll.
//!                          12.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   The return result of step 9 is the same string "Send message".
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0034


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035
//!@SYMAPI                   MAnimGeneralFunctions::DuplicateBitmapL(TInt)
//!@SYMAuthor                Yue Zhang
//!@SYMCreationDate          11-04-2008
//!@SYMTestCaseDesc          Send command and a bitmap handle to animation DLL to call DuplicateBitmap function, and then try to draw the bitmap.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Create CWsScreenDevice object and construct it.
//!                          10.Set required display mode of RWindow object.
//!                          11.Set background color of RWindow object.
//!                          12.Construct CWindowAnim object by RWindow.
//!                          13.Create a CFbsBitmap object and load bitmap.
//!                          14.Send ECmdAnimDuplicateBitmap command to plugin Dll with the handle.
//!                          14.1 Plugin draw the duplicated bitmap .
//!                          15.Use ScreenDevice object to compare the bitmap rectangle with a blank rectangle.
//!                          16.Close and destroy all the related objects.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   In step 15, the compare result should not be same because the bitmap should be drawn.
//!@SYMTestType              CIT
    START_TEST_BLOCK          1000          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        CREATE_OBJECT              CWsScreenDevice          scrdev
        CREATE_OBJECT              CFbsBitmap               bitmap
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-Construct_Command06
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-SetAutoFlush_Command07
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-new_Command08
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-Load_Command09
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-new_Command10
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-new_Command11
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-Construct_Command12
        COMMAND                    win                      SetRequiredDisplayMode          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-SetRequiredDisplayMode_Command13
        COMMAND                    win                      SetBackgroundColor          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-SetBackgroundColor_Command14
        COMMAND                    scrdev                   new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-new_Command15
        COMMAND                    win                      Activate                 
        COMMAND                    win                      BeginRedraw              
        COMMAND                    win                      EndRedraw                
        COMMAND                    scrdev                   Construct                
        COMMAND                    bitmap                   new                      
        COMMAND                    bitmap                   Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-Load_Command21
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-CommandReply_Command22
        COMMAND                    scrdev                   RectCompare              GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035-0001-RectCompare_Command23
        COMMAND                    bitmap                   ~                        
        COMMAND                    scrdev                   ~                        
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0035


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036
//!@SYMAPI                   MAnimGeneralFunctions::DuplicateBitmapL(TInt)
//!@SYMAuthor                Yue Zhang
//!@SYMCreationDate          11-04-2008
//!@SYMTestCaseDesc          Negative case, the client sends command and an invalid bitmap handle to animation DLL to call DuplicateBitmap function.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Set required display mode of RWindow object.
//!                          10.Set background color of RWindow object.
//!                          11.Create a CFbsBitmap object and load bitmap.
//!                          12.Send ECmdAnimDuplicateBitmap command to plugin Dll with the no-existing handle.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   In step 12, will get a WServ-7 panic.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        CREATE_OBJECT              CFbsBitmap               bitmap
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-Construct_Command13
        COMMAND                    win                      SetRequiredDisplayMode          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-SetRequiredDisplayMode_Command14
        COMMAND                    win                      SetBackgroundColor          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-SetBackgroundColor_Command15
        COMMAND                    bitmap                   new                      
        COMMAND                    bitmap                   Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-Load_Command17
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036-0001-CommandReply_Command18
    END_TEST_BLOCK    !PanicString=WSERV    !PanicCode=7
    RUN_TEST_STEP          100          T_GraphicsWservAPI          utilityClearPanicDlg

END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0036


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037
//!@SYMAPI                   MAnimGeneralFunctions::DuplicateBitmapL(TInt)
//!@SYMAuthor                Yue Zhang
//!@SYMCreationDate          11-04-2008
//!@SYMTestCaseDesc          The client sends command and a bitmap handle to animation DLL to call DuplicateBitmap function in the situation of memory leak.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Create CWsScreenDevice object and construct it.
//!                          10.Set required display mode of RWindow object.
//!                          11.Set background color of RWindow object.
//!                          12.Construct CWindowAnim object by RWindow.
//!                          13.Create a CFbsBitmap object and load bitmap.
//!                          14.Send ECmdUtilEatupMemory command to plugin Dll, the plugin dll will eatup the memory to cause the memory leak.
//!                          15.Send ECmdAnimDuplicateBitmap command to plugin Dll with the handle.
//!                          16.Send ECmdUtilFreeEatenMemory command to plugin Dll, the plugin dll will release the eaten memory.
//!                          17.Use ScreenDevice object to compare the bitmap rectangle with a blank rectangle.
//!                          18.Close and destroy all the related objects.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   In step 17, the compare result should be same because the bitmap should not be drawn.
//!@SYMTestType              CIT
    START_TEST_BLOCK          1000          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        CREATE_OBJECT              CWsScreenDevice          scrdev
        CREATE_OBJECT              CFbsBitmap               bitmap
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-Construct_Command06
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-SetAutoFlush_Command07
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-new_Command08
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-Load_Command09
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-new_Command10
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-new_Command11
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-Construct_Command12
        COMMAND                    win                      SetRequiredDisplayMode          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-SetRequiredDisplayMode_Command13
        COMMAND                    win                      SetBackgroundColor          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-SetBackgroundColor_Command14
        COMMAND                    scrdev                   new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-new_Command15
        COMMAND                    win                      Activate                 
        COMMAND                    win                      BeginRedraw              
        COMMAND                    win                      EndRedraw                
        COMMAND                    scrdev                   Construct                
        COMMAND                    bitmap                   new                      
        COMMAND                    bitmap                   Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-Load_Command21
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-CommandReply_Command22
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-CommandReply_Command23
        //COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-CommandReply_Command24
        //!COMMAND                    scrdev                   RectCompare              GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037-0001-RectCompare_Command25
        COMMAND                    bitmap                   ~                        
        COMMAND                    scrdev                   ~                        
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0037


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038
//!@SYMAPI                   MAnimGeneralFunctions::DuplicateFontL(TInt)
//!@SYMAuthor                Yue Zhang
//!@SYMCreationDate          11-04-2008
//!@SYMTestCaseDesc          The client sends command and a font handle to animation DLL to call DuplicateFont function, and then try to draw the font.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Create CWsScreenDevice object and construct it.
//!                          10.Set required display mode of RWindow object.
//!                          11.Set background color of RWindow object.
//!                          12.Create a TFontSpec object with the proper font name and height.
//!                          13.Create a CFont object using GetNearestFontInTwips of CWsScreenDevice object.
//!                          14.Send ECmdAnimDuplicateFont command to plugin Dll with the font's handle.
//!                          14.1 Plugin get the duplicated font's ID and return it to the client.
//!                          14.2 Wrapper verify it with the original font on the client side. If it's the same , set this case failed.
//!                          15.Close and destroy all the related objects.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   In step 14, the compare result should not be same because the bitmap should be drawn.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        CREATE_OBJECT              CWsScreenDevice          scrdev
        CREATE_OBJECT              CFbsFont                 font
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-Construct_Command06
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-SetAutoFlush_Command07
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-new_Command08
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-Load_Command09
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-new_Command10
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-new_Command11
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-Construct_Command12
        COMMAND                    win                      SetRequiredDisplayMode          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-SetRequiredDisplayMode_Command13
        COMMAND                    win                      SetBackgroundColor          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-SetBackgroundColor_Command14
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw              
        COMMAND                    win                      EndRedraw                
        COMMAND                    scrdev                   new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-new_Command18
        COMMAND                    scrdev                   Construct                
        COMMAND                    scrdev                   GetNearestFontToDesignHeightInTwips          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-GetNearestFontToDesignHeightInTwips_Command20
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038-0001-CommandReply_Command21
        COMMAND                    scrdev                   ~                        
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0038


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039
//!@SYMAPI                   MAnimGeneralFunctions::DuplicateFontL(TInt)
//!@SYMAuthor                Yue Zhang
//!@SYMCreationDate          11-04-2008
//!@SYMTestCaseDesc          Negative case, the client sends command and one invalid font handle to animation DLL to call DuplicateFont function, and then try to draw the font.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Set required display mode of RWindow object.
//!                          10.Set background color of RWindow object.
//!                          11.Send ECmdAnimDuplicateFont command to plugin Dll with a invalid font's handle.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   In step 11, will get a WServ-13 panic.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-Construct_Command13
        COMMAND                    win                      SetRequiredDisplayMode          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-SetRequiredDisplayMode_Command14
        COMMAND                    win                      SetBackgroundColor          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-SetBackgroundColor_Command15
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039-0001-CommandReply_Command16
    END_TEST_BLOCK    !PanicString=WSERV    !PanicCode=13
    RUN_TEST_STEP          100          T_GraphicsWservAPI          utilityClearPanicDlg

END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0039


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040
//!@SYMAPI                   MAnimGeneralFunctions::DuplicateFontL(TInt)
//!@SYMAuthor                Yue Zhang
//!@SYMCreationDate          11-04-2008
//!@SYMTestCaseDesc          The client sends command and a font handle to animation DLL to call DuplicateFont function, and then try to draw the font.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Create CWsScreenDevice object and construct it.
//!                          10.Set required display mode of RWindow object.
//!                          11.Set background color of RWindow object.
//!                          12.Create a TFontSpec object with the proper font name and height.
//!                          13.Create a CFont object using GetNearestFontInTwips of CWsScreenDevice object.
//!                          14.Send ECmdUtilEatupMemory command to plugin Dll, the plugin dll will eatup the memory to cause the memory leak.
//!                          15.Send ECmdAnimDuplicateFont command to plugin Dll with the font's handle.
//!                          15.1 Plugin can not get the duplicated font's ID and return zero to the client.
//!                          15.2 Wrapper verify the result. If it's zero, set this case failed and set the error -4(KErrNoMemory).
//!                          16.Send ECmdUtilFreeEatenMemory command to plugin Dll, the plugin dll will release the eaten memory.
//!                          17.Close and destroy all the related objects.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   In step 15, client get zero value and the the error code to -4(KErrNoMemory).
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        CREATE_OBJECT              CWsScreenDevice          scrdev
        CREATE_OBJECT              CFbsFont                 font
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-Construct_Command06
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-SetAutoFlush_Command07
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-new_Command08
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-Load_Command09
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-new_Command10
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-new_Command11
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-Construct_Command12
        COMMAND                    win                      SetRequiredDisplayMode          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-SetRequiredDisplayMode_Command13
        COMMAND                    win                      SetBackgroundColor          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-SetBackgroundColor_Command14
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw              
        COMMAND                    win                      EndRedraw                
        COMMAND                    scrdev                   new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-new_Command18
        COMMAND                    scrdev                   Construct                
        COMMAND                    scrdev                   GetNearestFontToDesignHeightInTwips          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-GetNearestFontToDesignHeightInTwips_Command20
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-CommandReply_Command21
        COMMAND          !Error=-4 animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-CommandReply_Command22
        //COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040-0001-CommandReply_Command23
        COMMAND                    scrdev                   ~                        
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0040


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041
//!@SYMAPI                   MAnimGeneralFunctions::CloseFont(CFbsFont ptr)
//!@SYMAuthor                Yue Zhang
//!@SYMCreationDate          11-04-2008
//!@SYMTestCaseDesc          The client sends command and a font handle to animation DLL to call DuplicateFont function, and then try to draw the font,after that, close the font.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Create CWsScreenDevice object and construct it.
//!                          10.Create CWindowGc of CWsScreenDevice.
//!                          11.Set required display mode of RWindow object.
//!                          12.Set background color of RWindow object.
//!                          13.Create a TFontSpec object with the proper font name and height.
//!                          14.Create a CFont object using GetNearestFontInTwips of CWsScreenDevice object.
//!                          15.Send ECmdAnimCloseFont command to plugin Dll with the font's handle.
//!                          16.Close and destroy all the related objects.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   In step 15,CloseFont function should be executed successfully.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        CREATE_OBJECT              CWsScreenDevice          scrdev
        CREATE_OBJECT              CWindowGc                wingc
        CREATE_OBJECT              CFbsFont                 font
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-Construct_Command13
        COMMAND                    win                      SetRequiredDisplayMode          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-SetRequiredDisplayMode_Command14
        COMMAND                    win                      SetBackgroundColor          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-SetBackgroundColor_Command15
        COMMAND                    scrdev                   new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-new_Command16
        COMMAND                    scrdev                   Construct                
        COMMAND                    scrdev                   GetNearestFontToDesignHeightInTwips          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-GetNearestFontToDesignHeightInTwips_Command18
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041-0001-CommandReply_Command19
        COMMAND                    scrdev                   ~                        
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0041


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042
//!@SYMAPI                   MAnimGeneralFunctions::ReplyBuf(const TDesC8 {ref})
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          23-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralReplyBuf8 to animation DLL by CommandReply, and then check if the returned result is the expected one.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralReplyBuf8 with the descriptor usded by ReplyBuf() to animation DLL by CommandReply.
//!                          9.1 In wrapper,set the slot 1 and slot 2 of IpcArgs associated with different TBuf8 descriptor.
//!                          9.2 The wrapper check the slot 1 of IpcArgs is the same with the descriptor sent to animation DLL, and the one in slot 2 of the IpcArgs does not change.
//!                          10. Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   After calling CommandReply(),the descriptor in IpcArgs slot 1 is the same with the descriptor sent to animation DLL and the one in IpcArgs slot 2 does not change.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0042


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043
//!@SYMAPI                   MAnimGeneralFunctions::ReplyBuf(const TDesC16 {ref})
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          23-04-2008
//!@SYMTestCaseDesc          The client sends command ECmdGeneralReplyBuf16 to animation DLL by CommandReply, and then check if the returned result is the expected one.
//!@SYMTestActions           1.  Create and connect a RWsSession.
//!                          2.  Create and construct RWindowGroup and RWindow.
//!                          3.  Activate the RWindow.
//!                          4.  SetAutoFlush to TRUE for the RWsSession.
//!                          5.  Create a RAnimDll and Load an animation DLL.
//!                          6.  Create a RAnim by using RAnimDll object.
//!                          7.  Create an instance of  RAnimForMClass .
//!                          8.  Complete construction of the RAnim based on the created RWindow.
//!                          9.  Send ECmdGeneralReplyBuf16 with the descriptor usded by ReplyBuf() to animation DLL by CommandReply.
//!                          9.1 In wrapper,set the slot 1 and slot 2 of IpcArgs associated with different TBuf16 descriptor.
//!                          9.2 The wrapper check the descriptor in IpcArgs slot 1 is the same with the descriptor sent to animation DLL,and the one in slot 2 of the IpcArgs does not change.
//!                          10.  Destroy RAnim and RAnimForMClass.
//!                          11. Destroy RAnimDll.
//!                          12. Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   After calling CommandReply(),the descriptor in IpcArgs slot 1 is the same with the descriptor sent to animation DLL and the one in IpcArgs slot 2 does not change.
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0043


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044
//!@SYMAPI                   MAnimGeneralFunctions::SystemTime()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          24/04/2008
//!@SYMTestCaseDesc          Set syncmode to ESyncDay, get the system time as it was when Animate() was last called.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSystemTime with ESyncDay to animation DLL by CommandReply.
//!                          9.1 Animation DLL verifies the behavior of API.
//!                          9.2 Wrapper checks the return value of step 10 is 1 or not.
//!                          10.Destroy RAnim and RAnimForMClass.
//!                          11.Destroy RAnimDll.
//!                          12.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   Step 9 return 1
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0044


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045
//!@SYMAPI                   MAnimGeneralFunctions::SystemTime()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          24/04/2008
//!@SYMTestCaseDesc          Set syncmode to ESyncMinute, get the system time as it was when Animate() was last called.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSystemTime with ESyncMinute to animation DLL by CommandReply.
//!                          9.1 Animation DLL verifies the behavior of API.
//!                          9.2 Wrapper checks the return value of step 10 is 1 or not.
//!                          10.Destroy RAnim and RAnimForMClass.
//!                          11.Destroy RAnimDll.
//!                          12.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   Step 9 return 1
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0045


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046
//!@SYMAPI                   MAnimGeneralFunctions::SystemTime()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          24/04/2008
//!@SYMTestCaseDesc          Set syncmode to ESyncSecond, get the system time as it was when Animate() was last called.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSystemTime with ESyncSecond to animation DLL by CommandReply.
//!                          9.1 Animation DLL verifies the behavior of API.
//!                          9.2 Wrapper checks the return value of step 10 is 1 or not.
//!                          10.Destroy RAnim and RAnimForMClass.
//!                          11.Destroy RAnimDll.
//!                          12.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   Step 9 return 1
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0046


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047
//!@SYMAPI                   MAnimGeneralFunctions::SystemTime()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          24/04/2008
//!@SYMTestCaseDesc          Set syncmode to ESyncFlash, get the system time as it was when Animate() was last called.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSystemTime with ESyncFlash to animation DLL by CommandReply.
//!                          9.1 Animation DLL verifies the behavior of API.
//!                          9.2 Wrapper checks the return value of step 10 is 1 or not.
//!                          10.Destroy RAnim and RAnimForMClass.
//!                          11.Destroy RAnimDll.
//!                          12.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   Step 9 return 1
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0047


START_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048
//!@SYMTestCaseID            GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048
//!@SYMAPI                   MAnimGeneralFunctions::SystemTime()
//!@SYMAuthor                Cherry Song
//!@SYMCreationDate          24/04/2008
//!@SYMTestCaseDesc          Set syncmode to ESyncNone and setinterval to 4, get the system time as it was when Animate() was last called.
//!@SYMTestActions           1.Create and connect a RWsSession.
//!                          2.Create and construct RWindowGroup and RWindow.
//!                          3.Activate the RWindow.
//!                          4.SetAutoFlush to TRUE for the RWsSession.
//!                          5.Create a RAnimDll object and Load an animation DLL.
//!                          6.Create a RAnim object by using RAnimDll object.
//!                          7.Create an instance of  RAnimForMClass .
//!                          8.Complete construction of the RAnim based on the created RWindow.
//!                          9.Send command ECmdGeneralSystemTime with ESyncNone to animation DLL by CommandReply.
//!                          9.1 Animation DLL verifies the behavior of API.
//!                          9.2 Wrapper checks the return value of step 10 is 1 or not.
//!                          10.Destroy RAnim and RAnimForMClass.
//!                          11.Destroy RAnimDll.
//!                          12.Close RWsSession ,RWindowGroup and RWindow.
//!@SYMTestStatus            Implemented
//!@SYMTestPriority          High
//!@SYMTestExpectedResults   Step 9 return 1
//!@SYMTestType              CIT
    START_TEST_BLOCK          10          T_GraphicsWservAPI          \graphics\GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi.ini
        CREATE_OBJECT              RWsSession               ws
        CREATE_OBJECT              RWindowGroup             wingp
        CREATE_OBJECT              RWindow                  win
        CREATE_OBJECT              RAnimDll                 animdll
        CREATE_OBJECT              RAnim                    anim
        CREATE_OBJECT              RAnimForMClass           animformc
        COMMAND                    ws                       new                      
        COMMAND                    ws                       Connect                  
        COMMAND                    wingp                    new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-new_Command03
        COMMAND                    wingp                    Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-Construct_Command04
        COMMAND                    win                      new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-new_Command05
        COMMAND                    win                      Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-Construct_Command06
        COMMAND                    win                      Activate
        COMMAND                    win                      BeginRedraw
        COMMAND                    win                      EndRedraw
        COMMAND                    ws                       SetAutoFlush             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-SetAutoFlush_Command08
        COMMAND                    animdll                  new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-new_Command09
        COMMAND                    animdll                  Load                     GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-Load_Command10
        COMMAND                    anim                     new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-new_Command11
        COMMAND                    animformc                new                      GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-new_Command12
        COMMAND                    animformc                Construct                GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-Construct_Command13
        COMMAND                    animformc                CommandReply             GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048-0001-CommandReply_Command14
        COMMAND                    anim                     Destroy                  
        COMMAND                    animformc                Destroy                  
        COMMAND                    animdll                  Destroy                  
        COMMAND                    win                      Close                    
        COMMAND                    wingp                    Close                    
        COMMAND                    ws                       Close                    
    END_TEST_BLOCK
END_TESTCASE          GRAPHICS-WSERV-AnimGeneralFunctions-PublicApi-0048


